# AI Trading System - Production Configuration
# Generated for production deployment on main-nilante.com

# =================================
# Trading API Configuration  
# =================================
# Using PAPER trading for safety
ALPACA_API_KEY=PK2GYAU6BB6LSJMY4QC3
ALPACA_API_SECRET=xLKyX1KTzPrLU1meg42zTgEr9McCaettaTHQTAaK
ALPACA_BASE_URL=https://paper-api.alpaca.markets

# =================================
# Data Provider APIs
# =================================
POLYGON_API_KEY=WSlDxuIvmyKSonjbETz0etsuIHVfDbq6
ALPHA_VANTAGE_API_KEY=XNIG084LXDEMLWMC
NEWS_API_KEY=fcc82714bcc248269bd86d6f2dc29f05
REDDIT_CLIENT_ID=wFEdoewug6Y884Sqb-RvuA
REDDIT_CLIENT_SECRET=Yt0dTysJBhMPOaohWWbDxv1doe1vEQ
EODHD_API_KEY=68bd259e28bf43.65903583
CALENDAR_PROVIDER=eodhd

# =================================
# Message Queue Configuration
# =================================
PULSAR_URL=pulsar://trading-pulsar:6650
PULSAR_HOST=trading-pulsar
PULSAR_PORT=6650

# =================================
# Database Configuration
# =================================
DB_USER=trading_user
DB_PASSWORD=Okunka!Blebogyan02$
DB_NAME=trading_db
DB_HOST=trading-postgres
DB_PORT=5432
DATABASE_URL=postgresql+asyncpg://trading_user:Okunka!Blebogyan02$@trading-postgres:5432/trading_db

REDIS_PASSWORD=Okunka!Blebogyan02$
REDIS_HOST=trading-redis
REDIS_PORT=6379
REDIS_URL=redis://:Okunka!Blebogyan02$@trading-redis:6379/0

# Database settings for trading_common config (requires DB_ prefix)
DB_REDIS_PASSWORD=Okunka!Blebogyan02$
DB_REDIS_HOST=trading-redis
DB_REDIS_PORT=6379
DB_REDIS_DB=0

# =================================
# Security Configuration (Production)
# =================================
SECRET_KEY=GaCV14oKwzp!Ro#JWgRE@LgA!b^^vLsapsaQe2oqH&$$BCYaT9%PsIurm$$z#19TT*
JWT_SECRET=g$$D18xM4gzUcEpg#jGx8m7TVjh7g!TyOCp62wWo4xR^@juT5kTKo59q0fLmz3QFL
JWT_SECRET_KEY=g$$D18xM4gzUcEpg#jGx8m7TVjh7g!TyOCp62wWo4xR^@juT5kTKo59q0fLmz3QFL
ENCRYPTION_KEY=wHweoNDqisk#nyu%F&$$VJz39K7VkSJWm
SECURITY_SECRET_KEY=GaCV14oKwzp!Ro#JWgRE@LgA!b^^vLsapsaQe2oqH&$$BCYaT9%PsIurm$$z#19TT*
ADMIN_PASSWORD_HASH=$$2b$$12$$fUy7vU3J1EeO51UlhJ0s7.Qk0SndsuhGLcQE2abtZxDlyWq5Qj4xm
KILL_SWITCH_ADMIN_KEY=Okunka!Blebogyan02$$

# =================================
# System Configuration
# =================================
ENVIRONMENT=production
LOG_LEVEL=INFO
DEBUG=false
ENFORCE_FAIL_CLOSED=true

# =================================
# CORS & Security Settings
# =================================
CORS_ORIGINS=https://trading.main-nilante.com,http://localhost:8000
TRUSTED_HOSTS=biz.mekoshi.com,admin.mekoshi.com,localhost,127.0.0.1,168.119.145.135
CORS_ALLOW_CREDENTIALS=true

# Authentication Settings
# Authentication Settings (updated)
BUSINESS_HOST=biz.mekoshi.com
ADMIN_HOST=admin.mekoshi.com
STRICT_DATA_MODE=false
REQUIRE_MFA_FOR_ADMIN=true
ACCESS_TOKEN_EXPIRE_MINUTES=15
REFRESH_TOKEN_EXPIRE_DAYS=7
JWT_EXPIRE_MINUTES=30  # legacy fallback
JWT_REFRESH_EXPIRE_DAYS=7  # legacy fallback
MAX_LOGIN_ATTEMPTS=5
LOCKOUT_DURATION_MINUTES=30

# Environment Admin Login (for development/bootstrap)
ENABLE_ENV_ADMIN_LOGIN=true
ADMIN_USERNAME=nilante
ADMIN_PASSWORD=Okunka!Blebogyan02$
ADMIN_USER_ID=env-admin
ADMIN_MFA_SECRET=

# =================================
# Resource Limits (Production)
# =================================
MAX_CPU_CORES=64
MAX_MEMORY_GB=900
MODEL_MEMORY_GB=512

# High-memory limits for containers
INGEST_MEM_LIMIT=512g
ML_MEM_LIMIT=600g
OLLAMA_MEM_LIMIT=600g
QUESTDB_MEM_LIMIT=512g
WEAVIATE_MEM_LIMIT=256g
POSTGRES_MEM_LIMIT=256g

# =================================
# Service Configuration
# =================================
API_PORT=8000
# Increased workers for parallel real-time processing of all watchlist symbols
API_WORKERS=50
MAX_CONNECTIONS_PER_WORKER=100

# Monitoring Ports
PROMETHEUS_PORT=9090
GRAFANA_PORT=3000
GRAFANA_USER=admin
GRAFANA_PASSWORD=Okunka!Blebogyan02$

# Vault Configuration
VAULT_TOKEN=dev-vault-token-123
VAULT_URL=http://vault:8200

# =================================
# Trading Settings
# =================================
PAPER_TRADING=true
TRADING_MODE=paper
MAX_POSITION_SIZE=10000
DEFAULT_STOP_LOSS=0.02
DEFAULT_TAKE_PROFIT=0.05
MAX_DAILY_LOSS=1000
RISK_CHECK_INTERVAL=30

# =================================
# Weaviate Settings
# =================================
WEAVIATE_AUTHENTICATION_APIKEY_ALLOWED_KEYS=Okunka!Blebogyan02$
WEAVIATE_AUTHENTICATION_APIKEY_USERS=trading_user
WEAVIATE_URL=http://trading-weaviate:8080
WEAVIATE_AUTHENTICATION_ANONYMOUS_ACCESS_ENABLED=false
WEAVIATE_AUTHENTICATION_APIKEY_ENABLED=true
WEAVIATE_GOMEMLIMIT=192GiB

# =================================
# MinIO Settings
# =================================
MINIO_ROOT_USER=trading_user
MINIO_ROOT_PASSWORD=Okunka!Blebogyan02$
MINIO_ENDPOINT=trading-minio:9000
MINIO_ROOT_PASSWORD_B64=T2t1bmthIUJsZWJvZ3lhbjAyJA==

# =================================
# Ollama Configuration (7 models available)
# =================================
OLLAMA_HOST=http://host.docker.internal:11434
OLLAMA_MODELS=qwen2.5:72b,mixtral:8x22b,deepseek-v3:latest,yi:34b,command-r-plus:104b,solar:10.7b,phi3:14b
OLLAMA_TIMEOUT=240
OLLAMA_MEMORY_LIMIT=512GB
OLLAMA_NUM_PARALLEL=8
OLLAMA_KEEP_ALIVE=-1

# =================================
# Additional Settings
# =================================
LETSENCRYPT_EMAIL=blamptey@nilante.com
REDIS_MAX_MEMORY=16gb
REDIS_MAX_MEMORY_POLICY=allkeys-lru

# =================================
# Additional API Keys (if available)
# =================================
FINNHUB_API_KEY=d366g41r01qumnp4cm0gd366g41r01qumnp4cm10
TWELVE_DATA_API_KEY=d06da0158acd45afb7f2e5eeb5550d2f

# =================================
# ML Service Configuration
# =================================
ML_SERVICE_URL=http://trading-ml:8001
ML_SERVICE_TIMEOUT=30
ML_MODEL_CACHE_DIR=/models
FINBERT_ENABLED=true

# =================================
# Data Service Configuration  
# =================================
DATA_SERVICE_URL=http://trading-data-ingestion:8002
DATA_COLLECTION_INTERVAL=60
DATA_RETENTION_DAYS=90

# =================================
# Signal Service Configuration
# =================================
SIGNAL_SERVICE_URL=http://trading-signal-generator:8003
SIGNAL_GENERATION_INTERVAL=60
SIGNAL_CONFIDENCE_THRESHOLD=0.7

# =================================
# QuestDB Configuration
# =================================
QUESTDB_HOST=trading-questdb
QUESTDB_HTTP_PORT=9000
QUESTDB_PG_PORT=8812
QUESTDB_INFLUX_PORT=9009
QUESTDB_USER=admin
QUESTDB_PASSWORD=quest
QUESTDB_JAVA_OPTS=-Xms16g -Xmx384g

# =================================
# Service Discovery
# =================================
API_SERVICE_HOST=trading-api
ML_SERVICE_HOST=trading-ml
DATA_SERVICE_HOST=trading-data-ingestion
SIGNAL_SERVICE_HOST=trading-signal-generator
EXECUTION_SERVICE_HOST=trading-execution
RISK_SERVICE_HOST=trading-risk-monitor
STRATEGY_SERVICE_HOST=trading-strategy-engine
BACKTEST_SERVICE_HOST=trading-backtesting

# =================================
# Outbound Email (Password Reset / Notifications)
# =================================
SMTP_HOST=smtp.mekoshi.com
SMTP_PORT=587
SMTP_USER=trading_svc@mekoshicom
SMTP_PASSWORD=Okunka!Blebogyan02$
SMTP_STARTTLS=true  
PASSWORD_RESET_SENDER=security@mekoshi.com

# ================================  =
# Cloudflare / ACME (Traefik DNS Challenge)
# =================================
# Provide a zone-scoped API Token with Zone:DNS:Edit (and optionally Zone:Zone:Read).
# Do NOT commit secrets. Fill these locally on the server only.
CLOUDFLARE_DNS_API_TOKEN=sPsLAgHYstt7ABrBMMuBzhprTAvGtNJEi57xbRE-
# If your token is zone-scoped and exposed as a Zone Token, set it here as well.
# You may reuse the same value as CLOUDFLARE_DNS_API_TOKEN if appropriate.
CLOUDFLARE_ZONE_API_TOKEN=sPsLAgHYstt7ABrBMMuBzhprTAvGtNJEi57xbRE-
CLOUDFLARE_EMAIL=blamptey@nilante.com

# --- Added by automation: Polygon API + Flat Files (S3) ---
POLYGON_S3_ENDPOINT=https://files.polygon.io
POLYGON_S3_BUCKET=flatfiles
POLYGON_S3_ACCESS_KEY_ID=383191df-6410-4919-8fb8-5e256c3727b6
POLYGON_S3_SECRET_ACCESS_KEY=WSlDxuIvmyKSonjbETz0etsuIHVfDbq6
POLYGON_S3_REGION=us-east-1

# =================================
# After-Hours Automations (Data Ingestion)
# =================================
# Options daily refresh loop
ENABLE_DAILY_OPTIONS=true
DAILY_OPTIONS_INTERVAL_SECONDS=3600
# Process ALL watchlist symbols - no artificial limits
DAILY_OPTIONS_MAX_UNDERLYINGS=0
DAILY_OPTIONS_PACING_SECONDS=0.05
DAILY_OPTIONS_EXPIRY_AHEAD_DAYS=90
DAILY_OPTIONS_EXPIRY_BACK_DAYS=60

# Options coverage reporter (daily JSON artifacts)
ENABLE_OPTIONS_COVERAGE_REPORT=true
OPTIONS_COVERAGE_INTERVAL_SECONDS=86400
# Process ALL watchlist symbols - no artificial limits
OPTIONS_COVERAGE_MAX_UNDERLYINGS=0

# Equities coverage reporter (daily JSON artifacts)
ENABLE_EQUITIES_COVERAGE_REPORT=true
EQUITIES_COVERAGE_INTERVAL_SECONDS=86400

# Weaviate reconcile (continuous recent-news indexing from QuestDB)
ENABLE_WEAVIATE_RECONCILE=true
WEAVIATE_RECONCILE_INTERVAL_SECONDS=300
WEAVIATE_RECONCILE_LOOKBACK_DAYS=3
WEAVIATE_RECONCILE_LIMIT=2000
ENABLE_WEAVIATE_SCHEMA_ENSURE=true

# =================================
# HISTORICAL BACKFILL CONFIGURATION
# Production Data Quotas:
#   - Equities: 20 years for all optionable symbols
#   - News/Social/Options/Calendar: 5 years
# =================================

# Master historical backfill control
ENABLE_HISTORICAL_BACKFILL=true
# Global historical limits - Process ALL watchlist symbols
HISTORICAL_BACKFILL_YEARS=20
HISTORICAL_BACKFILL_SYMBOLS=0

# Equity historical backfill (20-year requirement)
# Process ALL watchlist symbols - no artificial limits
ENABLE_EQUITY_BACKFILL_ON_START=true
EQUITY_BACKFILL_YEARS=20
EQUITY_BACKFILL_MAX_SYMBOLS=0
EQUITY_BACKFILL_CHUNK_SIZE=100

# Options historical backfill (5-year requirement)  
ENABLE_OPTIONS_HISTORICAL_BACKFILL=true
OPTIONS_BACKFILL_YEARS=5
# Process ALL watchlist symbols - no artificial limits
OPTIONS_BACKFILL_MAX_UNDERLYINGS=0

# News historical backfill (5-year requirement)
ENABLE_NEWS_HISTORICAL_BACKFILL=true
NEWS_BACKFILL_YEARS=5
# Process ALL watchlist symbols - no artificial limits
NEWS_BACKFILL_SYMBOLS=0

# Social historical backfill (5-year requirement)
ENABLE_SOCIAL_HISTORICAL_BACKFILL=true
SOCIAL_BACKFILL_YEARS=5
# Process ALL watchlist symbols - no artificial limits
SOCIAL_BACKFILL_SYMBOLS=0
SOCIAL_BACKFILL_CHUNK=50

# Calendar historical backfill (5-year requirement if available)
ENABLE_CALENDAR_HISTORICAL_BACKFILL=true
CALENDAR_BACKFILL_YEARS=5

# Light daily delta backfill (gap filling, hourly)
ENABLE_DAILY_DELTA=true
DAILY_DELTA_INTERVAL_SECONDS=300
DAILY_DELTA_LOOKBACK_DAYS=7
DAILY_DELTA_MAX_SYMBOLS=0
DAILY_DELTA_PACING_SECONDS=0.1

# Optional off-hours news stream (continuous feed)
ENABLE_NEWS_STREAM=true
NEWS_STREAM_INTERVAL_SECONDS=30
NEWS_STREAM_HOURS_BACK=24
NEWS_STREAM_MAX_ARTICLES=1000

# Quote streaming: always on, 24/7, full breadth
ENABLE_QUOTE_STREAM=true
QUOTE_STREAM_TRADING_HOURS_ONLY=false
QUOTE_STREAM_MAX_SYMBOLS=12000
QUOTE_STREAM_SAMPLE_SIZE=100

# Social stream: faster cadence
SOCIAL_STREAM_INTERVAL_SECONDS=15

# Options daily refresh: broaden scope and pace
ENABLE_DAILY_OPTIONS=true
DAILY_OPTIONS_INTERVAL_SECONDS=3600
DAILY_OPTIONS_MAX_UNDERLYINGS=2000
DAILY_OPTIONS_PACING_SECONDS=0.05
DAILY_OPTIONS_EXPIRY_AHEAD_DAYS=90
DAILY_OPTIONS_EXPIRY_BACK_DAYS=60

# Coverage reporters: increase underlyings
ENABLE_OPTIONS_COVERAGE_REPORT=true
OPTIONS_COVERAGE_INTERVAL_SECONDS=86400
OPTIONS_COVERAGE_MAX_UNDERLYINGS=2000

# =================================
# Housekeeping: archive/prune older JSON artifacts to MinIO
# =================================
ENABLE_HOUSEKEEPING=true
HOUSEKEEPING_INTERVAL_SECONDS=21600
HOUSEKEEPING_AGE_DAYS=30
HOUSEKEEPING_BUCKET=trading
HOUSEKEEPING_PREFIX=archives/ops-json
HOUSEKEEPING_PATHS=/srv,/srv/ai-trading-system
HOUSEKEEPING_PATTERNS=coverage_snapshot*.json,coverage_snapshot_full*.json,coverage_run_latest.json,coverage_summary_consolidated.json,retention_*_questdb.json,*_seed_report*.json,*_seed_checkpoint*.json,backfill_progress.json,storage_projection_*.json

# MinIO artifact uploads for dashboards (coverage JSON, etc.)
ENABLE_MINIO_ARTIFACT_UPLOAD=true
ARTIFACT_UPLOAD_INTERVAL_SECONDS=21600
GRAFANA_EXPORT_DIR=/app/export/grafana-csv
MINIO_ARTIFACTS_BUCKET=trading
MINIO_ARTIFACTS_PREFIX=dashboardsREDIS_MEM_LIMIT=256g

# Enable WebSocket streaming
ENABLE_WEBSOCKETS=true

# Finnhub Configuration (Free Tier: 60 calls/min)
FINNHUB_NEWS_ENABLED=false
FINNHUB_SYMBOLS_PER_WINDOW=5
FINNHUB_SYMBOL_SLEEP_SECONDS=1.2
FINNHUB_WEBSOCKET_ENABLED=false

# =================================
# ML Model Day/Night Mode Configuration
# =================================
# Market hours: 9:30 AM - 4:00 PM America/New_York (Mon-Fri)
MARKET_HOURS_TZ=America/New_York
MARKET_HOURS_OPEN=09:30
MARKET_HOURS_CLOSE=16:00

# Day mode: Fast, lightweight models for trading hours (real-time inference)
ML_DAY_HOT_MODELS=solar:10.7b,phi3:14b

# Night mode: Heavy models for deep analysis during off-hours
ML_NIGHT_HEAVY_MODELS=mixtral:8x22b,qwen2.5:72b,command-r-plus:104b,llama3.1:70b,yi:34b

# Enable automatic model warming on day/night transitions
ENABLE_WARM_SCHEDULER=true

# Router: Disable heavy models during market hours for fast inference
ROUTER_MARKET_DISABLE_HEAVY=true
ROUTER_HEAVY_MEMORY_GB=30
